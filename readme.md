<p align="center"><img src="http://130.255.78.128/images/logo.svg"></p>
<p align="center">Интерактивная карта компании ООО "Ресурс Транс"</p>

## О проекте

Для реализации проекта использовались следующие технологии:

- [PHP 7.3](https://www.php.net/releases/7_3_0.php).
- [Laravel 5.8](https://laravel.com/docs/5.8).
- [React 16.2.0](https://5abc31d8be40f1556f06c4be--reactjs.netlify.com)

## Минимальные требования

- Apache 2.4
- Mysql 5.7
- php 7.3
- Laravel 5.8
- php-soap
- composer

Для работы проекта необходимо переименовать файл [.env.example](.env.example) в ".env" и ввести необходимые параметры.

Далее необходимо выполнить последовательно следующие консольные команды в корне проекта:
- composer update
- php artisan key:generate
- npm install
- npm run prod (Если не сработает, тогда "npm run dev" или "npm run watch")
- php artisan migrate

После этого проект полностью готов для заполнения данными, полученными по API.

## API

Для получения необходимых для отображения точек на карте использовано API на основе технологии SOAP, предоставленное компанией ООО "Ресурс Транс". Адрес для получения доступа к API записан в ключе SOAP_ADDRESS файла [.env](.env) в корневой папке проекта. 


## Консольные команды

Для заполнения базы данных необходимо задать параметры подключения к базе данных в файле [.env](.env) и указать в нём имя базы данных.

Для полного заполнения БД необходимо последовательно выполнить команды:
- php artisan organizations:fill (Заполнение организаций)
- php artisan autocolumns:fill (Заполнение автоколонн)
- php artisan spots:fill (Заполнение участков и "плохих" участков)
- php artisan brigades:fill (Заполнение бригад)
- php artisan cars:fill (Заполнение машин. Данная команда может занять довольно долгое время)
- php artisan statistics:fill -f (Заполнение статистики)

После этого проект готов к работе. После данной процедуры все команды можно выполнять в любой последовательности, потому что данные уже будут перезаписаны, если, например, появятся новые данные в API.

Команда php artisan statistics:fill имеет несколько дополнительных опций, помимо "-f":
- "-a" - Заполнение информации только о Заявках;
- "-w" - Заполнение информации только о Путевых листах;
- "-t" - Заполнение информации только о ТопливоЧасах;
- "-m" - Заполнение информации только о Мониторинге;
- "-d" - Заполнение информации только о ДТП;
- "-f" - Заполнение всей информации последовательно;


## Файл names.php

Файл [names.php](storage/names.php) представляется собой php-массив, содержащий список коротких имен и названий городов для различных подразделений, путь к файлу можно получить в Laravel php-функцией storage_path("names.php").
При необходимости можно дополнять файл, команды автоматически найдут необходимое подразделение по его ID.